{"version":3,"file":"ng-cdk-table-virtual-scroll.js","sources":["ng://ng-cdk-table-virtual-scroll/lib/table-data-source.ts","ng://ng-cdk-table-virtual-scroll/lib/fixed-size-table-virtual-scroll-strategy.ts","ng://ng-cdk-table-virtual-scroll/lib/table-item-size.directive.ts","ng://ng-cdk-table-virtual-scroll/lib/table-virtual-scroll.module.ts","ng://ng-cdk-table-virtual-scroll/public-api.ts","ng://ng-cdk-table-virtual-scroll/ng-cdk-table-virtual-scroll.ts"],"sourcesContent":["import { DataSource } from '@angular/cdk/table';\r\nimport {\r\n  BehaviorSubject,\r\n  Observable,\r\n  ReplaySubject,\r\n  Subject,\r\n  Subscription,\r\n} from 'rxjs';\r\n\r\nexport class TableVirtualScrollDataSource<T> extends DataSource<T> {\r\n  /** Stream that emits when a new data array is set on the data source. */\r\n  private readonly _data: BehaviorSubject<T[]>;\r\n\r\n  /** Stream emitting render data to the table (depends on ordered data changes). */\r\n  private readonly _renderData = new BehaviorSubject<T[]>([]);\r\n\r\n  /**\r\n   * Subscription to the changes that should trigger an update to the table's rendered rows, such\r\n   * as filtering, sorting, pagination, or base data changes.\r\n   */\r\n  protected _renderChangesSubscription: Subscription | null = null;\r\n\r\n  public dataToRender$: Subject<T[]>;\r\n  public dataOfRange$: Subject<T[]>;\r\n  protected streamsReady: boolean;\r\n\r\n  /** Array of data that should be rendered by the table, where each object represents one row. */\r\n  get data() {\r\n    return this._data.value;\r\n  }\r\n  set data(data: T[]) {\r\n    this._data.next(data);\r\n  }\r\n\r\n  constructor(initialData: T[] = []) {\r\n    super();\r\n    this._data = new BehaviorSubject<T[]>(initialData);\r\n    this.updateChangeSubscription();\r\n  }\r\n\r\n  protected updateChangeSubscription() {\r\n    this.initStreams();\r\n    this._renderChangesSubscription = new Subscription();\r\n    this._renderChangesSubscription.add(\r\n      this._data.subscribe((data) => this.dataToRender$.next(data))\r\n    );\r\n    this._renderChangesSubscription.add(\r\n      this.dataOfRange$.subscribe((data) => this._renderData.next(data))\r\n    );\r\n  }\r\n\r\n  protected initStreams() {\r\n    if (!this.streamsReady) {\r\n      this.dataToRender$ = new ReplaySubject<T[]>(1);\r\n      this.dataOfRange$ = new ReplaySubject<T[]>(1);\r\n      this.streamsReady = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Used by the MatTable. Called when it connects to the data source.\r\n   * @private\r\n   */\r\n  connect(): Observable<T[] | readonly T[]> {\r\n    if (!this._renderChangesSubscription) {\r\n      this.updateChangeSubscription();\r\n    }\r\n\r\n    return this._renderData;\r\n  }\r\n\r\n  /**\r\n   * Used by the MatTable. Called when it disconnects from the data source.\r\n   * @private\r\n   */\r\n  disconnect() {\r\n    if (this._renderChangesSubscription) {\r\n      this._renderChangesSubscription.unsubscribe();\r\n    }\r\n    this._renderChangesSubscription = null;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { distinctUntilChanged } from 'rxjs/operators';\r\nimport { BehaviorSubject, Subject } from 'rxjs';\r\nimport { CdkVirtualScrollViewport, VirtualScrollStrategy } from '@angular/cdk/scrolling';\r\nimport { ListRange } from '@angular/cdk/collections';\r\n\r\nexport interface TSVStrategyConfigs {\r\n  rowHeight: number;\r\n  headerHeight: number;\r\n  footerHeight: number;\r\n  bufferMultiplier: number;\r\n}\r\n\r\n@Injectable()\r\nexport class FixedSizeTableVirtualScrollStrategy implements VirtualScrollStrategy {\r\n  private rowHeight!: number;\r\n  private headerHeight!: number;\r\n  private footerHeight!: number;\r\n  private bufferMultiplier!: number;\r\n  private indexChange = new Subject<number>();\r\n  public stickyChange = new Subject<number>();\r\n\r\n  public viewport: CdkVirtualScrollViewport;\r\n\r\n  public renderedRangeStream = new BehaviorSubject<ListRange>({start: 0, end: 0});\r\n\r\n  public scrolledIndexChange = this.indexChange.pipe(distinctUntilChanged());\r\n\r\n  get dataLength(): number {\r\n    return this._dataLength;\r\n  }\r\n\r\n  set dataLength(value: number) {\r\n    this._dataLength = value;\r\n    this.onDataLengthChanged();\r\n  }\r\n\r\n  private _dataLength = 0;\r\n\r\n  public attach(viewport: CdkVirtualScrollViewport): void {\r\n    this.viewport = viewport;\r\n    this.viewport.renderedRangeStream.subscribe(this.renderedRangeStream);\r\n    this.onDataLengthChanged();\r\n  }\r\n\r\n  public detach(): void {\r\n    this.indexChange.complete();\r\n    this.stickyChange.complete();\r\n    this.renderedRangeStream.complete();\r\n  }\r\n\r\n  public onContentScrolled(): void {\r\n    this.updateContent();\r\n  }\r\n\r\n  public onDataLengthChanged(): void {\r\n    if (this.viewport) {\r\n      this.viewport.setTotalContentSize(this.dataLength * this.rowHeight + this.headerHeight + this.footerHeight);\r\n    }\r\n    this.updateContent();\r\n  }\r\n\r\n  public onContentRendered(): void {\r\n    // no-op\r\n  }\r\n\r\n  public onRenderedOffsetChanged(): void {\r\n    // no-op\r\n  }\r\n\r\n  public scrollToIndex(index: number, behavior?: ScrollBehavior): void {\r\n    if (!this.viewport || !this.rowHeight) {\r\n      return;\r\n    }\r\n    this.viewport.scrollToOffset((index - 1 ) * this.rowHeight + this.headerHeight);\r\n  }\r\n\r\n  public setConfig(configs: TSVStrategyConfigs) {\r\n    const {rowHeight, headerHeight, footerHeight, bufferMultiplier} = configs;\r\n    if (\r\n      this.rowHeight === rowHeight\r\n      && this.headerHeight === headerHeight\r\n      && this.footerHeight === footerHeight\r\n      && this.bufferMultiplier === bufferMultiplier\r\n    ) {\r\n      return;\r\n    }\r\n    this.rowHeight = rowHeight;\r\n    this.headerHeight = headerHeight;\r\n    this.footerHeight = footerHeight;\r\n    this.bufferMultiplier = bufferMultiplier;\r\n    this.onDataLengthChanged();\r\n  }\r\n\r\n  private updateContent() {\r\n    if (!this.viewport || !this.rowHeight) {\r\n      return;\r\n    }\r\n    const scrollOffset = this.viewport.measureScrollOffset();\r\n    const amount = Math.ceil(this.viewport.getViewportSize() / this.rowHeight);\r\n    const offset = Math.max(scrollOffset - this.headerHeight, 0);\r\n    const buffer = Math.ceil(amount * this.bufferMultiplier);\r\n\r\n    const skip = Math.round(offset / this.rowHeight);\r\n    const index = Math.max(0, skip);\r\n    const start = Math.max(0, index - buffer);\r\n    const end = Math.min(this.dataLength, index + amount + buffer);\r\n    const renderedOffset = start * this.rowHeight;\r\n    this.viewport.setRenderedContentOffset(renderedOffset);\r\n    this.viewport.setRenderedRange({start, end});\r\n    this.indexChange.next(index);\r\n    this.stickyChange.next(renderedOffset);\r\n  }\r\n}\r\n","import {\r\n  AfterContentInit,\r\n  ContentChild,\r\n  Directive,\r\n  forwardRef,\r\n  Input,\r\n  NgZone,\r\n  OnChanges,\r\n  OnDestroy,\r\n} from '@angular/core';\r\nimport {\r\n  distinctUntilChanged,\r\n  filter,\r\n  map,\r\n  switchMap,\r\n  takeUntil,\r\n  takeWhile,\r\n  tap,\r\n} from 'rxjs/operators';\r\nimport { Subject } from 'rxjs';\r\nimport { VIRTUAL_SCROLL_STRATEGY } from '@angular/cdk/scrolling';\r\nimport { CdkHeaderRowDef, CdkTable } from '@angular/cdk/table';\r\n\r\nimport { TableVirtualScrollDataSource } from './table-data-source';\r\nimport { FixedSizeTableVirtualScrollStrategy } from './fixed-size-table-virtual-scroll-strategy';\r\n\r\nexport function _tableVirtualScrollDirectiveStrategyFactory(\r\n  tableDir: TableItemSizeDirective\r\n) {\r\n  return tableDir.scrollStrategy;\r\n}\r\n\r\nconst stickyHeaderSelector = '.cdk-header-row .cdk-table-sticky';\r\nconst stickyFooterSelector = '.cdk-footer-row .cdk-table-sticky';\r\n\r\nconst defaults = {\r\n  rowHeight: 48,\r\n  headerHeight: 56,\r\n  headerEnabled: true,\r\n  footerHeight: 48,\r\n  footerEnabled: false,\r\n  bufferMultiplier: 0.7,\r\n};\r\n\r\n@Directive({\r\n  selector: 'cdk-virtual-scroll-viewport[tvsItemSize]',\r\n  providers: [\r\n    {\r\n      provide: VIRTUAL_SCROLL_STRATEGY,\r\n      useFactory: _tableVirtualScrollDirectiveStrategyFactory,\r\n      deps: [forwardRef(() => TableItemSizeDirective)],\r\n    },\r\n  ],\r\n})\r\nexport class TableItemSizeDirective\r\n  implements OnChanges, AfterContentInit, OnDestroy {\r\n  private alive = true;\r\n\r\n  // tslint:disable-next-line:no-input-rename\r\n  @Input('tvsItemSize')\r\n  rowHeight = defaults.rowHeight;\r\n\r\n  @Input()\r\n  headerEnabled = defaults.headerEnabled;\r\n\r\n  @Input()\r\n  headerHeight = defaults.headerHeight;\r\n\r\n  @Input()\r\n  footerEnabled = defaults.footerEnabled;\r\n\r\n  @Input()\r\n  footerHeight = defaults.footerHeight;\r\n\r\n  @Input()\r\n  bufferMultiplier = defaults.bufferMultiplier;\r\n\r\n  @ContentChild(CdkTable, { static: false })\r\n  table: CdkTable<any>;\r\n\r\n  scrollStrategy = new FixedSizeTableVirtualScrollStrategy();\r\n\r\n  dataSourceChanges = new Subject<void>();\r\n\r\n  private stickyPositions: Map<HTMLElement, number>;\r\n\r\n  constructor(private zone: NgZone) {}\r\n\r\n  ngOnDestroy() {\r\n    this.alive = false;\r\n    this.dataSourceChanges.complete();\r\n  }\r\n\r\n  private isAlive() {\r\n    return () => this.alive;\r\n  }\r\n\r\n  private isStickyEnabled(): boolean {\r\n    return (\r\n      !!this.scrollStrategy.viewport &&\r\n      (this.table['_headerRowDefs'] as CdkHeaderRowDef[])\r\n        .map((def) => def.sticky)\r\n        .reduce((prevState, state) => prevState && state, true)\r\n    );\r\n  }\r\n\r\n  ngAfterContentInit() {\r\n    const switchDataSourceOrigin = this.table['_switchDataSource'];\r\n    this.table['_switchDataSource'] = (dataSource: any) => {\r\n      switchDataSourceOrigin.call(this.table, dataSource);\r\n      this.connectDataSource(dataSource);\r\n    };\r\n\r\n    this.connectDataSource(this.table.dataSource);\r\n\r\n    this.scrollStrategy.stickyChange\r\n      .pipe(\r\n        filter(() => this.isStickyEnabled()),\r\n        tap(() => {\r\n          if (!this.stickyPositions) {\r\n            this.initStickyPositions();\r\n          }\r\n        }),\r\n        takeWhile(this.isAlive())\r\n      )\r\n      .subscribe((stickyOffset) => {\r\n        this.setSticky(stickyOffset);\r\n      });\r\n  }\r\n\r\n  connectDataSource(dataSource: any) {\r\n    this.dataSourceChanges.next();\r\n    if (dataSource instanceof TableVirtualScrollDataSource) {\r\n      dataSource.dataToRender$\r\n        .pipe(\r\n          distinctUntilChanged(),\r\n          takeUntil(this.dataSourceChanges),\r\n          takeWhile(this.isAlive()),\r\n          tap((data) => (this.scrollStrategy.dataLength = data.length)),\r\n          switchMap((data) =>\r\n            this.scrollStrategy.renderedRangeStream.pipe(\r\n              map(({ start, end }) =>\r\n                typeof start !== 'number' || typeof end !== 'number'\r\n                  ? data\r\n                  : data.slice(start, end)\r\n              )\r\n            )\r\n          )\r\n        )\r\n        .subscribe((data) => {\r\n          this.zone.run(() => {\r\n            dataSource.dataOfRange$.next(data);\r\n          });\r\n        });\r\n    } else {\r\n      throw new Error(\r\n        '[tvsItemSize] requires TableVirtualScrollDataSource be set as [dataSource] of [cdk-table]'\r\n      );\r\n    }\r\n  }\r\n\r\n  ngOnChanges() {\r\n    const config = {\r\n      rowHeight: +this.rowHeight || defaults.rowHeight,\r\n      headerHeight: this.headerEnabled\r\n        ? +this.headerHeight || defaults.headerHeight\r\n        : 0,\r\n      footerHeight: this.footerEnabled\r\n        ? +this.footerHeight || defaults.footerHeight\r\n        : 0,\r\n      bufferMultiplier: +this.bufferMultiplier || defaults.bufferMultiplier,\r\n    };\r\n    this.scrollStrategy.setConfig(config);\r\n  }\r\n\r\n  setSticky(offset) {\r\n    this.scrollStrategy.viewport.elementRef.nativeElement\r\n      .querySelectorAll(stickyHeaderSelector)\r\n      .forEach((el: HTMLElement) => {\r\n        const parent = el.parentElement;\r\n        let baseOffset = 0;\r\n        if (this.stickyPositions.has(parent)) {\r\n          baseOffset = this.stickyPositions.get(parent);\r\n        }\r\n        el.style.top = `${baseOffset - offset}px`;\r\n      });\r\n    this.scrollStrategy.viewport.elementRef.nativeElement\r\n      .querySelectorAll(stickyFooterSelector)\r\n      .forEach((el: HTMLElement) => {\r\n        const parent = el.parentElement;\r\n        let baseOffset = 0;\r\n        if (this.stickyPositions.has(parent)) {\r\n          baseOffset = this.stickyPositions.get(parent);\r\n        }\r\n        el.style.bottom = `${-baseOffset + offset}px`;\r\n      });\r\n  }\r\n\r\n  private initStickyPositions() {\r\n    this.stickyPositions = new Map<HTMLElement, number>();\r\n    this.scrollStrategy.viewport.elementRef.nativeElement\r\n      .querySelectorAll(stickyHeaderSelector)\r\n      .forEach((el) => {\r\n        const parent = el.parentElement;\r\n        if (!this.stickyPositions.has(parent)) {\r\n          this.stickyPositions.set(parent, parent.offsetTop);\r\n        }\r\n      });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\n\r\nimport { TableItemSizeDirective } from './table-item-size.directive';\r\n\r\n@NgModule({\r\n  declarations: [TableItemSizeDirective],\r\n  exports: [TableItemSizeDirective],\r\n  imports: [],\r\n})\r\nexport class TableVirtualScrollModule {}\r\n","/*\r\n * Public API Surface of ng-fixed-size-table-virtual-scroll\r\n */\r\n\r\nexport * from './lib/table-virtual-scroll.module';\r\nexport * from './lib/table-item-size.directive';\r\nexport * from './lib/fixed-size-table-virtual-scroll-strategy';\r\nexport * from './lib/table-data-source';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}